!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(module,__webpack_exports__,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var ParserService=function(){function ParserService(e,t){_classCallCheck(this,ParserService),this.elementCache=t.elementCache,this.collectionCache=t.collectionCache,this.bridgeMapper=e}return _createClass(ParserService,[{key:"analyzeThis",value:function(e,t,r){this.parseBind(e,t,r),this.parseActions(e,t,r),e.getAttribute("data-repeat")?this.parseForeach(e,t,r):this.analyzeNode(e,t,r)}},{key:"analyzeNode",value:function(e,t,r){for(var n=e.children,i=0;i<n.length;i++){var a=n[i];this.analyzeThis(a,t,r)}}},{key:"globalizePath",value:function(e,t){var r=t;for(".."===e.slice(0,2)&&(e=e.slice(2),r=r.slice(0,r.lastIndexOf(".")));"."===e[0];)e=e.slice(1),r=r.slice(0,r.lastIndexOf("."));return r+"."+e}},{key:"createHandler",value:function(e,t){var r=this;return function(n){n.stopImmediatePropagation(),r.bridgeMapper.fireCommand(e,t)}}},{key:"createBindingInfo",value:function(e,t,r,n,i){return{element:e,key:t,insideTemplate:r,converter:n,parameter:i}}},{key:"saveBinding",value:function(e,t){this.elementCache[e]?this.elementCache[e].push(t):this.elementCache[e]=[t]}},{key:"parseActions",value:function parseActions(child,dataContext,insideTemplate){var actionsAttributeValue=child.getAttribute("data-actions");if(actionsAttributeValue){var context=dataContext,bindingDescriptor=eval("("+actionsAttributeValue+")");for(var key in bindingDescriptor)if(bindingDescriptor.hasOwnProperty(key)){var descriptor=bindingDescriptor[key],path=null,parameter=null;"string"==typeof descriptor||descriptor instanceof String?(path=descriptor,parameter=null):(path=descriptor.command,parameter=descriptor.parameter);var binding=this.createBindingInfo(child,key,insideTemplate,null,parameter),overridenDataContext=child.getAttribute("data-context");overridenDataContext&&(dataContext=overridenDataContext);var bindingPath=this.globalizePath(path,dataContext);this.saveBinding(bindingPath,binding);var value=this.createHandler(bindingPath,parameter);child.addEventListener(key,value)}}}},{key:"parseBind",value:function parseBind(child,dataContext,insideTemplate){var bindAttributeValue=child.getAttribute("data-bind");if(bindAttributeValue){var that=this,context=dataContext,bindingDescriptor=eval("("+bindAttributeValue+")");for(var key in bindingDescriptor)if(bindingDescriptor.hasOwnProperty(key)){var descriptor=bindingDescriptor[key],path=null,converter=function(e){return e};"string"==typeof descriptor||descriptor instanceof String?path=descriptor:(path=descriptor.path,converter=descriptor.converter);var binding=this.createBindingInfo(child,key,insideTemplate,converter),overridenDataContext=child.getAttribute("data-context");overridenDataContext&&(dataContext=overridenDataContext);var bindingPath=this.globalizePath(path,dataContext);if(this.saveBinding(bindingPath,binding),"value"===key)if("radio"===child.type){var bpath=bindingPath;child.addEventListener("change",function(){if(child.checked){var e=child.value,t=child.getAttribute("data-selected-bind"),r=t?that.globalizePath(t,bpath):bpath;that.bridgeMapper.propertySet(r,e)}})}else{var bpath=bindingPath;child.addEventListener("input",function(){var e=child.value;that.bridgeMapper.propertySet(bpath,e)})}if("checked"===key&&"checkbox"===child.type){var bpath=bindingPath;child.addEventListener("change",function(){var e=child.checked;that.bridgeMapper.propertySet(bpath,e)})}this.bridgeMapper.registerBinding(bindingPath,insideTemplate)}}}},{key:"parseForeach",value:function(e,t,r){var n=e.getAttribute("data-repeat");if(n){var i=t+"."+n,a=e.children[0];this.collectionCache[i]={rootElement:e,template:a},e.removeChild(a),this.bridgeMapper.registerBinding(i,r)}}}]),ParserService}();__webpack_exports__.a=ParserService},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parserService=t,this.elementCache=r.elementCache}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r)}(e,[{key:"getNextPath",value:function(e,t,r){var n=t,i=e.length+1,a=n.substring(i),o=a.indexOf("]"),c=n.substr(0,i),s=a.substr(o),l=n.substr(e.length+1,o),u=parseInt(l),d=r(u);return{nextPath:c+d+s,index:u,newIndex:d}}},{key:"renderCollectionItemFromTemplate",value:function(e,t,r,n){var i=this,a=t.cloneNode(!0);if(n<r.children.length){r.insertBefore(a,r.children[n]);var o=Object.keys(this.elementCache).filter(function(t){return 0===t.indexOf(e+"[")}).reduce(function(e,t){return e[t]=i.elementCache[t],e},{}),c={};for(var s in o)if(o.hasOwnProperty(s)){var l=this.getNextPath(e,s,function(e){return e+1});l.index>=n&&(c[l.nextPath]=this.elementCache[s],delete this.elementCache[s])}for(var u in c)c.hasOwnProperty(u)&&(this.elementCache[u]=c[u])}else r.appendChild(a);this.parserService.analyzeThis(a,e+"["+n+"]",!0)}},{key:"renderForeach",value:function(e,t,r,n){for(;n.firstChild;)n.removeChild(n.firstChild);for(var i=0;i<e.length;i++)this.renderCollectionItemFromTemplate(t,r,n,i)}}]),e}();t.a=i},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bridge=t,this.registerBinding=this.registerBinding.bind(this),this.propertySet=this.propertySet.bind(this),this.fireCommand=this.fireCommand.bind(this),this.appReady=this.appReady.bind(this)}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r)}(e,[{key:"registerBinding",value:function(e,t){t?this.bridge.sendMessage({functionName:"RegisterBindingCollection",params:[e]}):this.bridge.sendMessage({functionName:"RegisterBinding",params:[e,!1]})}},{key:"propertySet",value:function(e,t){this.bridge.sendMessage({functionName:"PropertySet",params:[e,t]})}},{key:"fireCommand",value:function(e,t){var r=t||"";this.bridge.sendMessage({functionName:"FireCommand",params:[e,r]})}},{key:"appReady",value:function(){this.bridge.sendMessage({functionName:"Init",params:[]})}}]),e}();t.a=i},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewCache={},this.eventListeners={},this.collectionCache=a.collectionCache,this.elementCache=a.elementCache,this.bridgeMapper=t,this.viewLoaderService=r,this.parserService=n,this.rendererService=i,this.jsbind=this.jsbind.bind(this),this.navigateTo=this.navigateTo.bind(this),this.handleCollectionChange=this.handleCollectionChange.bind(this),this.setValue=this.setValue.bind(this)}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r)}(e,[{key:"on",value:function(e,t){void 0===this.eventListeners[e]&&(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}},{key:"jsbind",value:function(){this.frame=document.querySelector("[data-mvvmstart]");for(var e=document.querySelectorAll("[data-view]"),t=0;t<e.length;t++){var r=e[t],n=r.getAttribute("data-view");this.viewCache[n]={element:r,initialized:!1},r.parentElement.removeChild(r)}this.bridgeMapper.appReady()}},{key:"navigateTo",value:function(e){var t=this;if(this.viewCache[e]){var r=this.viewCache[e].element;if(!this.viewCache[e].initialized){var n=r,i=n.getAttribute("data-context");this.parserService.analyzeNode(n,i),this.viewCache[e].initialized=!0}for(;this.frame.firstChild;)this.frame.removeChild(this.frame.firstChild);this.frame.appendChild(r),this.broadcast("ViewChange",{prev:this.currentView,next:e}),this.currentView=e}else this.viewLoaderService.loadView(e,function(r){t.viewCache[e]={element:r,initialized:!1},t.navigateTo(e)})}},{key:"handleCollectionChange",value:function(e,t){var r=this,n=this.collectionCache[e],i=n.rootElement,a=n.template;switch(t.Action){case 0:this.rendererService.renderCollectionItemFromTemplate(e,a,i,t.NewStartingIndex);break;case 4:var o=Object.keys(this.elementCache).filter(function(e){return 0===e.indexOf(n+"[")}).reduce(function(e,t){return e[t]=r.elementCache[t],e},{});for(var c in o)if(o.hasOwnProperty(c))for(var s=o[c],l=0;l<s.length;l++){s[l].insideTemplate&&delete this.elementCache[c]}}}},{key:"setValue",value:function(e,t){var r=this,n=this.elementCache[e];if(n)for(var i=0;i<n.length;i++){var a=n[i],o=a.key,c=a.element;switch(o){case"mvvmvisible":c.style.display=a.converter(t);break;case"mvvmbgcolor":c.style.backgroundColor=a.converter(t);break;case"mvvmbgimage":c.style.backgroundImage=a.converter(t);break;case"mvvmsubview":c[o]?c[o]!==t&&this.broadcast("SubviewChange",{el:c,oldVal:c[o],newVal:t}):this.broadcast("SubviewChange",{el:c,oldVal:null,newVal:t}),c[o]=t;break;default:c[o]=a.converter(t)}}var s=this.collectionCache[e];if(s){var l=s.template;this.rendererService.renderForeach(t,e,l,s.rootElement)}var u=Object.keys(this.elementCache).filter(function(t){return 0===t.indexOf(e+".")}).reduce(function(e,t){return e[t]=r.elementCache[t],e},{});if(u)for(var d in u)if(u.hasOwnProperty(d)){var h=d;this.bridgeMapper.registerBinding(h,!1)}}},{key:"broadcast",value:function(e,t){for(var r in this.eventListeners)if(r===e){for(var n=0;n<this.eventListeners[r].length;n++)this.eventListeners[r][n](t);break}}}]),e}();t.a=i},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(global,factory){module.exports=function(global){"use strict";var _Base64=global.Base64,version="2.4.8",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e.charAt(r)]=r;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),n=[b64chars.charAt(r>>>18),b64chars.charAt(r>>>12&63),t>=2?"=":b64chars.charAt(r>>>6&63),t>=1?"=":b64chars.charAt(63&r)];return n.join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return fromCharCode(55296+(r>>>10))+fromCharCode(56320+(1023&r));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,r=t%4,n=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),i=[fromCharCode(n>>>16),fromCharCode(n>>>8&255),fromCharCode(255&n)];return i.length-=[0,0,2,1][r],i.join("")},atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/[\s\S]{1,4}/g,cb_decode)},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(e){return encode(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}global.Meteor&&(Base64=global.Base64);module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__));return{Base64:global.Base64}}(global)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this)}).call(this,__webpack_require__(5))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},,,function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t);var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r)}(e,[{key:"loadView",value:function(e,t){var r=new XMLHttpRequest;r.open("GET","Views/"+e+".html",!0),r.onreadystatechange=function(){if(4!==this.readyState)return null;if(200!==this.status)return null;var e=document.createElement("div");e.innerHTML=this.responseText;var r=e.firstChild;t(r)},r.send()}}]),e}());r(4);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=this.start.bind(this),this.receiveMessage=this.receiveMessage.bind(this),this.sendMessage=this.sendMessage.bind(this),window.receiveMessage=this.receiveMessage}return function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(e,[{key:"start",value:function(e){this.service=e,this.service.jsbind()}},{key:"receiveMessage",value:function(e,t){var r=window.Base64.decode(t),n=JSON.parse(r);this.service[n.FunctionName].apply(this,n.Params)}},{key:"sendMessage",value:function(e){window.NotifyCs.notify(JSON.stringify(e))}}]),e}()),c=r(0),s=r(1),l=r(2),u=r(3),d={elementCache:{},collectionCache:{}},h=new l.a(o),f=new c.a(h,d),b=new s.a(f,d),v=new u.a(h,i,f,b,d);o.start(v)}]);